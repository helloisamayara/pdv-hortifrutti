<!-- Modal de Localizar Produtos -->
<input type="checkbox" id="modal-search-toggle" class="modal-toggle" />
<div class="modal">
  <div class="modal-box w-11/12 max-w-2xl relative">
    <label for="modal-search-toggle"
           class="btn btn-sm btn-circle absolute right-4 top-4 hover:bg-gray-200">✕</label>
    <h3 class="text-2xl font-bold mb-4">Localizar Produtos</h3>
    <input type="text"
           id="searchInput"
           placeholder="Busque por nome ou código..."
           class="input input-bordered w-full mb-4"/>
    <div id="searchResults" class="space-y-2 max-h-80 overflow-auto">
      <p class="text-center text-gray-500">Digite acima para buscar.</p>
    </div>
  </div>
</div>

<!-- Modal de Finalizar Venda -->
<input type="checkbox" id="modal-finalizar-toggle" class="modal-toggle" />
<div class="modal">
  <div class="modal-box w-11/12 max-w-md relative">
    <label for="modal-finalizar-toggle"
           class="btn btn-sm btn-circle absolute right-4 top-4 hover:bg-gray-200">✕</label>
    <h3 class="text-2xl font-bold mb-4">Finalizar Venda</h3>
    <div class="mb-6 p-4 bg-gray-100 rounded-lg">
      <span class="text-gray-600 block">Total</span>
      <span id="totalModal" class="text-3xl font-extrabold text-green-600">
        {{ '%.2f'|format(total) }}
      </span>
    </div>
    <div class="form-control mb-6">
      <span class="label-text font-medium mb-2 block">Forma de Pagamento</span>
      <div class="flex gap-4">
        {% for pm,label in [('dinheiro','Dinheiro'),('debito','Débito'),('credito','Crédito'),('pix','PIX')] %}
        <label class="inline-flex items-center space-x-2">
          <input type="radio" name="pagamento" value="{{ pm }}" class="radio radio-primary"
                 {% if pm=='dinheiro' %}checked{% endif %}/>
          <span>{{ label }}</span>
        </label>
        {% endfor %}
      </div>
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6">
      <div class="form-control">
        <label class="label"><span class="label-text font-medium">Desconto (%)</span></label>
        <input type="number" id="modal-desconto" value="0" min="0" max="100" step="1"
               class="input input-bordered" placeholder="Digite um desconto..."/>
      </div>
      <div class="form-control">
        <label class="label"><span class="label-text font-medium">Recebido (R$)</span></label>
        <input type="number" id="modal-recebido" value="0" min="0" step="0.01"
               class="input input-bordered" placeholder="Quanto o cliente pagou?"/>
      </div>
    </div>
    <div id="trocoContainer" class="form-control mb-6 hidden">
      <label class="label"><span class="label-text font-medium">Troco (R$)</span></label>
      <input type="text" id="modal-troco" readonly class="input input-bordered bg-gray-100"/>
    </div>
    <div class="modal-action justify-end">
      <label for="modal-finalizar-toggle" class="btn btn-outline mr-2">Cancelar</label>
      <button id="btn-confirmar-venda" class="btn btn-primary">Confirmar</button>
    </div>
  </div>
</div>

<!-- Modal de Preview de Cupom -->
<input type="checkbox" id="modal-cupom-toggle" class="modal-toggle" />
<div class="modal">
  <div class="modal-box w-11/12 max-w-lg relative">
    <label for="modal-cupom-toggle"
           class="btn btn-sm btn-circle absolute right-4 top-4 hover:bg-gray-200">✕</label>
    <h3 class="text-2xl font-bold mb-4">Preview de Cupom</h3>
    <div id="cupomPreview" class="space-y-2 text-sm font-mono">
      <div>
        <strong>Data:</strong> <span id="cupom-data"></span>
        &nbsp; <strong>Hora:</strong> <span id="cupom-hora"></span>
      </div>
      <div><strong>Produtos:</strong></div>
      <ul id="cupom-lista" class="pl-4 list-disc"></ul>
      <div class="flex justify-between mt-4">
        <span><strong>Pagamento:</strong> <span id="cupom-pagamento"></span></span>
        <span><strong>Desconto:</strong> <span id="cupom-desconto"></span>%</span>
      </div>
      <div class="flex justify-between text-lg font-bold mt-2 border-t pt-2">
        <span>Total:</span>
        <span>R$ <span id="cupom-total"></span></span>
      </div>
    </div>
    <div class="modal-action justify-end">
      <label for="modal-cupom-toggle" class="btn btn-primary">OK</label>
    </div>
  </div>
</div>
